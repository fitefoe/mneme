<div ng-controller="OverviewCtrl">
  <!-- filter panel -->
  <div class="panel panel-info mneme-panel-filter">
    <!-- filter panel heading -->
    <div ng-click="filter_show = !filter_show"
        class="panel-heading mneme-pointer">
      <span class="glyphicon glyphicon-filter"></span> Filter
      <!-- arrow pointing down or up -->
      <span ng-if="!filter_show" class="caret"></span>
      <span ng-if="filter_show" class="dropup">
        <span class="caret"></span>
      </span>

      <!-- list of selected filter tags (stop click event propagation to
           preven the panel from closing) -->
      <a href=""
          ng-repeat="tag in filter_tags"
          ng-click="filter_tags_remove(tag); $event.stopPropagation();"
          class="label label-primary mneme-tag mneme-hover-base">
        {{tag}}
        <span class="glyphicon glyphicon-minus-sign mneme-hover-target"></span>
      </a>
    </div>
    <!-- filter panel body -->
    <div class="panel-body" ng-show="filter_show">
      <div ng-if="filter_tags_remaining.length">
        <label>Pick one or more of the following tags to filter your mnemes!</label>
        <div>
          <a href=""
              ng-repeat="tag in filter_tags_remaining | orderBy: '-count'"
              ng-click="filter_tags_add(tag.name)"
              class="label label-info mneme-tag mneme-hover-base">
            {{tag.name}}
            <span class="mneme-badge">{{tag.count}}</span>
            <span class="glyphicon glyphicon-plus-sign mneme-hover-target"></span>
          </a>
        </div>
      </div>
      <label ng-if="!filter_tags_remaining.length">
        There are no more tags for refining the filter!
      </label>
      <hr>
      <!-- TODO: map filter -->
      <div>
        <label>
          <input type="checkbox" ng-model="filter_map_show">
          Restrict to area on map
        </label>
        <div style="height: 300px; padding-left: 20px; padding-right: 20px; background-color: #DDDDDD;" ng-if="filter_map_show"></div>
      </div>
    </div>
  </div>

  <!-- filtererd mneme list -->
  <table class="table table-striped table-hover table-vmiddle">
    <thead>
      <tr>
        <th>Name</th>
        <th>Deadline</th>
        <th>Creation date</th>
        <th>Distance from map center</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="mneme in mnemes_filtered | orderBy: '+name'">
        <td>
          <h4>{{mneme.name}}</h4>
          <span ng-repeat="tag in mneme.tags">
            <span ng-if="!filter_tags_contains(tag)"
                class="mneme-tag label label-info">
              {{tag}}
            </span>
          </span>
        </td>
        <td></td>
        <td>11 months ago</td>
        <td>6 km</td>
        <td>
          <button type="button" class="btn btn-primary mneme-btn">
            <span class="glyphicon glyphicon-edit"></span> edit
          </button>
          <button type="button" class="btn btn-danger mneme-btn">
            <span class="glyphicon glyphicon-remove"></span> remove
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
